// startHandler.js
import { mainKeyboard, showMainKeyboard } from "../utils.js";

export function registerStartHandler(bot, deps) {
  const { logger } = deps;

  bot.onText(/^\/start$/, async (msg) => {
    const chatId = msg.chat.id;
    logger.info(`/start –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${chatId}`);

    await showMainKeyboard(
      bot,
      chatId,
      "–ü—Ä–∏–≤–µ—Ç! üëã –Ø –±–æ—Ç –¥–ª—è —É—á—ë—Ç–∞ –±—é–¥–∂–µ—Ç–∞.\n\n–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –∏–∑ –º–µ–Ω—é –Ω–∏–∂–µ:"
    );
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é"
  bot.onText(/–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é/, async (msg) => {
    const chatId = msg.chat.id;
    logger.info(`–ú–µ–Ω—é: –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${chatId}`);

    // –≠–º—É–ª–∏—Ä—É–µ–º –∫–æ–º–∞–Ω–¥—É /add
    await bot.sendMessage(chatId, "/add");
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ü–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å"
  bot.onText(/–ü–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å/, async (msg) => {
    const chatId = msg.chat.id;
    logger.info(`–ú–µ–Ω—é: –ü–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${chatId}`);

    // –≠–º—É–ª–∏—Ä—É–µ–º –∫–æ–º–∞–Ω–¥—É /balance
    await bot.sendMessage(chatId, "/balance");
  });
}
